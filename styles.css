/* Urban Happiness Mapper - Styles */
:root{
  --bg:#0b1220;
  --panel:#111a2e;
  --card:rgba(255,255,255,.05);
  --text:#e9eefc;
  --muted:#b6c1df;
  --border:rgba(255,255,255,.12);
  --primary:#7aa2ff;
  --primary-strong:#6b90f5;
  --accent:#ff5f6d;
  --shadow:0 20px 50px rgba(0,0,0,.35);
  --radius:18px;
  --bottombar-h:18px;
}

*{ box-sizing:border-box; }
html, body { height:100%; margin:0; }

body{
  font-family:"Manrope", "Segoe UI", Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
  height:100vh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
  position:relative;
}


body::before,
body::after{
  content:"";
  position:fixed;
  inset:-20% -10% auto;
  height:60vh;
  z-index:-1;
  pointer-events:none;
  background:radial-gradient(ellipse at top left, rgba(122,162,255,.18), transparent 60%);
}

body::after{
  inset:auto -10% -30% auto;
  height:70vh;
  background:radial-gradient(ellipse at bottom right, rgba(255,95,109,.16), transparent 60%);
}

/* ---------------- Top Header Bar ---------------- */
.topbar{
  flex:0 0 auto;
  padding:18px 22px 10px;
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:16px;
  flex-wrap:wrap;
  border-bottom:1px solid var(--border);
}

.brand{
  max-width:900px;
}

.topbar-actions{
  display:flex;
  align-items:center;
  gap:10px;
}

.kicker{
  margin:0 0 6px;
  text-transform:uppercase;
  letter-spacing:.18em;
  font-size:11px;
  color:var(--muted);
}

h1{
  margin:0;
  font-family:"Fraunces", "Times New Roman", serif;
  font-size:26px;
}

.sub{
  margin:6px 0 0;
  color:var(--muted);
  font-size:13px;
  line-height:1.4;
}

/* ---------------- Info card ---------------- */
.infoCard{
  margin-top:12px;
  padding:12px;
  border-radius:14px;
  border:1px solid var(--border);
  background:var(--card);
}

.infoTitle{
  font-family:"Fraunces", "Times New Roman", serif;
  font-size:14px;
  margin-bottom:6px;
}

.infoRow{
  display:flex;
  align-items:center;
  gap:10px;
  justify-content:space-between;
}

.infoText{
  margin:0;
  font-size:12.5px;
  color:var(--muted);
  line-height:1.5;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  flex:1;
  min-width:0;
}

.infoTrigger{
  margin-top:0;
  white-space:nowrap;
}

.infoLabel{
  display:inline;
}

.infoLabelCompact{
  display:none;
}

.infoLabelCompact{
  display:none;
}

/* ---------------- Button Styles ---------------- */
.btn{
  border-radius:12px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.06);
  color:var(--text);
  padding:10px 14px;
  cursor:pointer;
  font-weight:650;
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

a.btn{ text-decoration:none; display:inline-flex; align-items:center; }

.btn:hover{ transform:translateY(-1px); box-shadow:0 10px 20px rgba(0,0,0,.35); }
.btn:disabled{ cursor:not-allowed; opacity:.55; box-shadow:none; transform:none; }

.btn.primary{
  background:linear-gradient(135deg, rgba(122,162,255,.95) 0%, rgba(122,162,255,.6) 100%);
  border-color:rgba(122,162,255,.45);
  color:#fff;
}

.btn.ghost{
  background:rgba(122,162,255,.12);
  border-color:rgba(122,162,255,.28);
  color:var(--text);
}

.btn.danger{
  background:rgba(255,95,109,.15);
  border-color:rgba(255,95,109,.35);
  color:var(--text);
}

/* ---------------- Main Layout Grid ---------------- */
.layout{
  flex:1 1 auto;
  min-height:0;
  display:grid;
  grid-template-columns: minmax(0, 1fr) minmax(320px, 380px);
  grid-auto-rows:minmax(0, 1fr);
  gap:18px;
  padding:0 18px var(--bottombar-h);
}

.panel{
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:16px;
  overflow:auto;
  min-height:0;
  box-shadow:var(--shadow);
  animation:fadeUp .6s ease both;
  animation-delay:.05s;
}

.mapWrap{
  position:relative;
  min-height:0;
  height:100%;
  width:100%;
  border-radius:var(--radius);
  overflow:hidden;
  border:1px solid var(--border);
  box-shadow:var(--shadow);
  animation:fadeUp .6s ease both;
}

#map{
  width:100%;
  height:100%;
  min-height:240px;
}

/* ---------------- Crosshair Overlay ---------------- */
.crosshair{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:500;
  background:radial-gradient(circle at 50% 50%, rgba(255,255,255,.95) 0 2px, transparent 3px);
}

.crosshair::before,
.crosshair::after{
  content:"";
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  background:rgba(255,255,255,.92);
  box-shadow:0 0 0 2px rgba(0,0,0,.2);
  border-radius:999px;
}

.crosshair::before{ width:34px; height:2px; }
.crosshair::after{ width:2px; height:34px; }

.mapHud{
  position:absolute;
  left:12px;
  bottom:12px;
  z-index:600;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid var(--border);
  background:rgba(17,26,46,.78);
  font-size:12px;
  color:var(--muted);
  box-shadow:0 12px 24px rgba(0,0,0,.35);
}

.mapButton{
  position:absolute;
  top:64px;
  right:12px;
  z-index:650;
  padding:8px 10px;
  border-radius:999px;
  border:1px solid rgba(122,162,255,.35);
  background:rgba(17,26,46,.85);
  color:var(--text);
  font-size:11px;
  font-weight:700;
  letter-spacing:.03em;
  cursor:pointer;
}

.northArrow{
  position:relative;
  width:46px;
  height:46px;
  border-radius:50%;
  border:1px solid var(--border);
  background:rgba(17,26,46,.78);
  display:flex;
  align-items:center;
  justify-content:center;
  color:var(--text);
  font-weight:700;
  font-size:13px;
  box-shadow:0 10px 20px rgba(0,0,0,.35);
  pointer-events:none;
}

.northArrow::before{
  content:"";
  position:absolute;
  width:0;
  height:0;
  border-left:6px solid transparent;
  border-right:6px solid transparent;
  border-bottom:10px solid var(--primary);
  top:8px;
}

.leaflet-bottom .leaflet-control-scale.leaflet-control {
  bottom: 20% !important;
  right: 18px !important;
  left: auto !important;
  /* increase spacing from edges */
}

.hudLabel{ text-transform:uppercase; letter-spacing:.12em; font-size:10px; }
.hudValue{ font-weight:700; color:var(--text); margin-top:2px; }
.hudNote{ margin-top:4px; font-size:11px; }

/* ---------------- Form Elements and Typography ---------------- */
h2{
  margin:14px 0 10px;
  font-size:16px;
  font-family:\"Fraunces\", \"Times New Roman\", serif;
}

.hint{ color:var(--muted); font-size:12.5px; line-height:1.35; }

.field{ margin-top:12px; }
label{ display:block; color:var(--muted); font-size:12px; margin-bottom:6px; }

input, textarea, select{
  width:100%;
  border-radius:12px;
  border:1px solid var(--border);
  background:rgba(255,255,255,.06);
  color:var(--text);
  padding:10px;
  outline:none;
  font-family:inherit;
}

input:focus, textarea:focus, select:focus{
  border-color:rgba(122,162,255,.6);
  box-shadow:0 0 0 3px rgba(122,162,255,.16);
}

.is-invalid{
  border-color:rgba(209,73,91,.7);
  box-shadow:0 0 0 3px rgba(209,73,91,.18);
}

textarea{ resize:vertical; }
input[type=\"range\"]{ accent-color: var(--primary); }
input[type=\"range\"]{
  height:6px;
}
input[type=\"range\"]::-webkit-slider-thumb{
  appearance:none;
  width:20px;
  height:20px;
  border-radius:50%;
  background:var(--primary);
  border:2px solid rgba(255,255,255,.7);
  box-shadow:0 4px 10px rgba(0,0,0,.35);
  cursor:pointer;
}
input[type=\"range\"]::-moz-range-thumb{
  width:20px;
  height:20px;
  border-radius:50%;
  background:var(--primary);
  border:2px solid rgba(255,255,255,.7);
  box-shadow:0 4px 10px rgba(0,0,0,.35);
  cursor:pointer;
}

.grid2{ display:grid; grid-template-columns:repeat(2, minmax(0, 1fr)); gap:10px; }
.rangeValue{ margin-top:6px; font-size:12px; color:var(--muted); }
.rangeValueInline{
  margin-left:auto;
  font-size:12px;
  color:var(--muted);
}
.actions{ display:flex; gap:10px; flex-wrap:wrap; }

.sep{ border:none; border-top:1px solid var(--border); margin:16px 0; }

.count{ margin:8px 0 10px; color:var(--muted); font-size:12px; }
.list{ display:grid; gap:12px; }

.rangeCard{
  padding:12px;
  border-radius:14px;
  border:1px solid var(--border);
  background:var(--card);
}

.rangeCard label{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

/* ---------------- Status + Stats ---------------- */
.statusRow{
  display:flex;
  align-items:center;
  gap:10px;
  flex-wrap:wrap;
  margin-top:12px;
}

.statusRow.compact .statusMeta{
  font-size:12px;
  color:var(--muted);
}

.statusPill{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid var(--border);
  background:rgba(17,26,46,.7);
  font-size:12px;
  font-weight:600;
}

.statusDot{
  width:8px;
  height:8px;
  border-radius:50%;
  background:rgba(0,0,0,.35);
}

.statusDot[data-state="ok"]{ background:var(--primary); }
.statusDot[data-state="warn"]{ background:#f2c14e; }
.statusDot[data-state="error"]{ background:var(--danger); }
.statusDot[data-state="loading"]{
  background:var(--primary);
  animation:pulse 1.2s infinite;
}

.statusMeta{ font-size:12px; color:var(--muted); }

.stats{
  display:grid;
  grid-template-columns:repeat(3, minmax(0, 1fr));
  gap:10px;
  margin-top:12px;
}

.statCard{
  border:1px solid var(--border);
  border-radius:14px;
  padding:10px;
  background:var(--card);
}

.statLabel{
  font-size:11px;
  color:var(--muted);
  text-transform:uppercase;
  letter-spacing:.12em;
}

.statValue{
  font-size:18px;
  font-weight:700;
  margin-top:4px;
}

.legend{
  margin-top:12px;
  padding:10px;
  border-radius:14px;
  border:1px dashed rgba(122,162,255,.35);
  background:rgba(122,162,255,.08);
  font-size:12px;
  color:var(--muted);
}

.legendTitle{ font-weight:700; color:var(--text); margin-bottom:6px; }

.legendRow{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
}

.legendDot{
  width:10px;
  height:10px;
  border-radius:999px;
  display:inline-block;
}

.legendDot.happy1{ background:#d1495b; }
.legendDot.happy2{ background:#f08a4b; }
.legendDot.happy3{ background:#f2c14e; }
.legendDot.happy4{ background:#7fd1ae; }
.legendDot.happy5{ background:#2a9d8f; }

.legendHint{ margin-top:6px; font-size:11px; }

/* ---------------- Segmented control ---------------- */
.segmented{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:6px;
  background:rgba(255,255,255,.08);
  border:1px solid var(--border);
  border-radius:12px;
  padding:4px;
}

.segmentedItem{
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
}

.segmentedItem input{
  position:absolute;
  opacity:0;
  pointer-events:none;
}

.segmentedItem span{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:100%;
  padding:8px 10px;
  border-radius:10px;
  color:var(--muted);
  font-weight:600;
  transition:all .2s ease;
}

.segmentedItem input:checked + span{
  background:var(--primary);
  color:#fff;
  box-shadow:0 6px 14px rgba(31,122,77,.22);
}

/* Survey point cards in the collected points list */
.card{
  border:1px solid var(--border);
  border-radius:16px;
  padding:12px;
  background:var(--card);
  box-shadow:0 12px 20px rgba(24,24,24,.05);
  animation:fadeUp .4s ease both;
}

.cardHeader{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:8px;
}

.cardTitle{ font-weight:800; font-size:14px; margin:0; }
.cardMeta{ color:var(--muted); font-size:12px; margin-top:6px; line-height:1.3; }

.cardTags{ display:flex; gap:6px; flex-wrap:wrap; }

.pill{
  padding:4px 8px;
  border-radius:999px;
  background:rgba(122,162,255,.16);
  color:var(--text);
  font-size:11px;
  font-weight:700;
}

.pill.warn{
  background:rgba(224,122,95,.15);
  color:#9a4a38;
}

.cardRatings{ display:flex; gap:8px; margin-top:10px; }
.rating{
  padding:4px 8px;
  border-radius:999px;
  border:1px solid var(--border);
  font-size:11px;
  font-weight:700;
}

.cardComment{ margin-top:8px; font-size:12px; }
.cardActions{ display:flex; gap:8px; margin-top:10px; flex-wrap:wrap; }

.emptyState{
  padding:12px;
  border-radius:12px;
  border:1px dashed var(--border);
  color:var(--muted);
  font-size:12px;
  background:rgba(255,255,255,.05);
}

/* ---------------- Submission Notice ---------------- */
.submitNotice{
  margin-top:10px;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(122,162,255,.3);
  background:rgba(122,162,255,.12);
  color:var(--text);
  font-size:12px;
  display:none;
}

.submitNotice.visible{
  display:block;
  animation:fadeUp .35s ease;
}

.submitNotice[data-tone=\"warn\"]{
  border-color:rgba(224,122,95,.35);
  background:rgba(240,138,75,.15);
  color:#8c4a34;
}


/* ---------------- Modal ---------------- */
.modal{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1300;
}

.modal.is-open{
  display:flex;
}

.modalBackdrop{
  position:absolute;
  inset:0;
  background:rgba(5,9,18,.72);
  backdrop-filter: blur(4px);
}

.modalCard{
  position:relative;
  z-index:1;
  width:min(720px, 92vw);
  max-height:82vh;
  overflow:auto;
  background:#0f1629;
  border-radius:18px;
  border:1px solid var(--border);
  box-shadow:0 34px 70px rgba(12,18,16,.24);
  padding:16px;
  animation:fadeUp .25s ease;
}

.modalHeader{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  border-bottom:1px solid var(--border);
  padding-bottom:10px;
}

.modalHeader h3{
  margin:0;
  font-family:"Fraunces", "Times New Roman", serif;
  font-size:18px;
}

.modalBody{
  margin-top:12px;
  font-size:13px;
  color:var(--muted);
  line-height:1.55;
}

.modalBody p{ margin:0 0 12px; }
.modalBody p:last-child{ margin-bottom:0; }

/* ---------------- Animations ---------------- */
@keyframes fadeUp{
  from{ opacity:0; transform:translateY(8px); }
  to{ opacity:1; transform:translateY(0); }
}

@keyframes pulse{
  0%{ box-shadow:0 0 0 0 rgba(77,124,255,.5); }
  70%{ box-shadow:0 0 0 6px rgba(77,124,255,0); }
  100%{ box-shadow:0 0 0 0 rgba(77,124,255,0); }
}

/* ---------------- Mobile Responsive Design ---------------- */
@media (max-width: 900px){
  .survey .layout{
    grid-template-columns: minmax(0, 1fr) minmax(0, 1.2fr);
    grid-template-rows: 1fr;
    padding:0 14px var(--bottombar-h);
  }

  .survey .mapWrap{ border-radius:16px; height:100%; }
  .survey .panel{ border-radius:16px; height:100%; }

  .viewer .layout{
    grid-template-columns: 1fr;
    grid-template-rows: minmax(260px, 52vh) 1fr;
    padding:0 14px var(--bottombar-h);
  }

  .viewer .mapWrap{ border-radius:16px; }
  .viewer .panel{ border-radius:16px; }

  .stats{ grid-template-columns:repeat(2, minmax(0, 1fr)); }
  .grid2{ grid-template-columns:1fr; }
  .btn{ padding: 12px 14px; }
  input, textarea, select{ padding: 12px; }
}

@media (max-width: 600px){
  .topbar{ padding:14px 14px 8px; }
  h1{ font-size:22px; }
  .sub{ font-size:12.5px; }
  .topbar-actions{ width:100%; }
  .topbar-actions .btn{ width:100%; justify-content:center; }

  .survey .layout{ gap:12px; padding:0 12px 16px; grid-template-columns:minmax(140px, 1fr) minmax(0, 1.4fr); }
  .survey .mapWrap{ border-radius:14px; }
  .survey .panel{ border-radius:14px; padding:14px; }

  .viewer .layout{ gap:12px; padding:0 12px 16px; }
  .viewer .mapWrap{ border-radius:14px; }
  .viewer .panel{ border-radius:14px; padding:14px; }
  .mapHud{ padding:8px 10px; font-size:11px; }
  .hudLabel{ font-size:9px; }
  .mapButton{ top:56px; padding:7px 9px; font-size:10px; }

  .statusRow.compact{ flex-direction:column; align-items:flex-start; }
  .infoCard{ padding:10px; }
  .infoRow{ flex-direction:column; align-items:flex-start; }
  .infoTrigger{ width:100%; }
  .infoRow .infoTrigger{ margin-top:6px; }
  .actions .btn{ flex:1 1 140px; }
  .modalCard{ padding:14px; }
  .mapHud{ display:none; }
  .infoText{ display:none; }
  .infoLabel{ display:none; }
  .infoLabelCompact{ display:inline; }
}
